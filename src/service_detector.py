# src/service_detector.py

class ServiceDetector:
    def __init__(self, scanned_ports):
        self.scanned_ports = scanned_ports

    def detect_services(self):
        services = {}
        for port, details in self.scanned_ports.items():
            services[port] = {
                "name": details.get('name', 'unknown'),
                "state": details.get('state', 'unknown'),
                "version": details.get('version', 'unknown')
            }
        return services

