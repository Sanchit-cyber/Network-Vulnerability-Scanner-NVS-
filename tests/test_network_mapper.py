# tests/test_network_mapper.py

import unittest
from unittest.mock import patch
from src.network_mapper import NetworkMapper

class TestNetworkMapper(unittest.TestCase):
    @patch('scapy.all.srp')
    def test_map_network(self, mock_srp):
        # Mock the response from the scapy srp function
        mock_srp.return_value = ([('sent', {'psrc': '192.168.1.10', 'hwsrc': '00:11:22:33:44:55'})], None)
        
        network_mapper = NetworkMapper()
        devices = network_mapper.map_network("192.168.1.0/24")
        
        # Validate that devices are correctly identified
        self.assertEqual(len(devices), 1)
        self.assertEqual(devices[0]['ip'], '192.168.1.10')
        self.assertEqual(devices[0]['mac'], '00:11:22:33:44:55')

if __name__ == '__main__':
    unittest.main()
