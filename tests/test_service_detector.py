# tests/test_service_detector.py

import unittest
from src.service_detector import ServiceDetector

class TestServiceDetector(unittest.TestCase):
    def setUp(self):
        # Sample scanned ports data for testing
        self.scanned_ports = {
            80: {'name': 'http', 'state': 'open', 'version': '2.4.41'},
            22: {'name': 'ssh', 'state': 'open', 'version': '8.4'},
            21: {'name': 'ftp', 'state': 'closed'}
        }
        self.service_detector = ServiceDetector(self.scanned_ports)

    def test_detect_services(self):
        services = self.service_detector.detect_services()
        
        # Validate the services detected
        self.assertIn(80, services)
        self.assertIn(22, services)
        self.assertNotIn(21, services)  # Expecting closed ports not to be included
        
        self.assertEqual(services[80]['name'], 'http')
        self.assertEqual(services[22]['version'], '8.4')

if __name__ == '__main__':
    unittest.main()

